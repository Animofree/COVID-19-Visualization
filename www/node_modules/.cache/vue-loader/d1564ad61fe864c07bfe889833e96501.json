{"remainingRequest":"C:\\Users\\Meng Yin\\Desktop\\COVID-19-Visualization\\www\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\Meng Yin\\Desktop\\COVID-19-Visualization\\www\\src\\components\\Map.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\Meng Yin\\Desktop\\COVID-19-Visualization\\www\\src\\components\\Map.vue","mtime":1587021198609},{"path":"C:\\Users\\Meng Yin\\Desktop\\COVID-19-Visualization\\www\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Meng Yin\\Desktop\\COVID-19-Visualization\\www\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"C:\\Users\\Meng Yin\\Desktop\\COVID-19-Visualization\\www\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Meng Yin\\Desktop\\COVID-19-Visualization\\www\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7TWFwQ3RsLCBsb2FkUG9seWdvbn0gZnJvbSAiLi4vanMvbWFwIjsKaW1wb3J0IHtQcm92aW5jZXN9IGZyb20gIi4uL2pzL3JlZ2lvbiI7CmltcG9ydCAqIGFzIG1hcHRhbGtzIGZyb20gJ21hcHRhbGtzJzsKaW1wb3J0IHtsb2FkQnVpbGRpbmd9IGZyb20gIi4uL2pzL2J1aWxkaW5nIjsKaW1wb3J0IHtsb2FkTGluZXMzRH0gZnJvbSAiLi4vanMvbGluZXMzRCI7CmltcG9ydCB7VXRpbHN9IGZyb20gJy4uL2pzL3V0aWxzJzsKCmV4cG9ydCBkZWZhdWx0IHsKICAgIG5hbWU6ICdNYXAnLAogICAgZGF0YSgpIHsKICAgICAgICByZXR1cm4gewogICAgICAgICAgICBtYXA6IG51bGwsCiAgICAgICAgICAgIHBsYW5lTGF5ZXI6IG51bGwsCiAgICAgICAgICAgIGJ1aWxkaW5nTGF5ZXI6IG51bGwsCiAgICAgICAgICAgIGN1cnJlbnRQcm92aW5jZTogIjUxMDAwMCIsCiAgICAgICAgICAgIGN1cnJlbnRDaXR5OiAiIiwKICAgICAgICAgICAgZGF0YTogbnVsbCwKICAgICAgICAgICAgbWFwczogWwogICAgICAgICAgICAgICAge2xhYmVsOiAn5bi46KeE5Zyw5Zu+JywgbWFwOiAnR2FvZGUnLCB0eXBlOiAnMCcsIGluZGV4OiAwfSwKICAgICAgICAgICAgICAgIHtsYWJlbDogJ+aal+m7kTIuNUQnLCBtYXA6ICdHYW9kZScsIHR5cGU6ICcxJywgaW5kZXg6IDF9LAogICAgICAgICAgICAgICAge2xhYmVsOiAnM0TlnLrmma8nLCBtYXA6ICdHYW9kZScsIHR5cGU6ICcxJywgaW5kZXg6IDJ9XSwKICAgICAgICAgICAgbWFwSW5kZXg6IDEsCiAgICAgICAgICAgIHByb3ZpbmNlczogT2JqZWN0LmtleXMoUHJvdmluY2VzKS5tYXAoayA9PiAoe2NvZGU6IGssIG5hbWU6IFByb3ZpbmNlc1trXS5uYW1lfSkpCiAgICAgICAgfTsKICAgIH0sCiAgICBtb3VudGVkKCkgewogICAgICAgIHRoaXMubWFwSW5kZXggPSBwYXJzZUludChVdGlscy5nZXRDb29raWUoIm1hcEluZGV4IiwgMSkpOwogICAgICAgIHRoaXMuaW5pdCgpOwogICAgICAgIHRoaXMubG9hZFByb3ZpbmNlKHRoaXMuY3VycmVudFByb3ZpbmNlKTsKICAgIH0sCiAgICBtZXRob2RzOiB7CiAgICAgICAgaW5pdCgpIHsKICAgICAgICAgICAgbGV0IG1hcENvbmZpZyA9IE1hcEN0bC5nZXRDb25maWcoKTsKICAgICAgICAgICAgdGhpcy5tYXAgPSBuZXcgbWFwdGFsa3MuTWFwKCdtYXAnLCBtYXBDb25maWcpOwogICAgICAgICAgICB0aGlzLm1hcC5vbignbW92ZWVuZCcsIE1hcEN0bC5oYW5kbGVNYXBNb3ZlKTsKICAgICAgICB9LAogICAgICAgIGxvYWRQcm92aW5jZShjb2RlKSB7CiAgICAgICAgICAgIGxldCAkdGhpcyA9IHRoaXM7CiAgICAgICAgICAgIE1hcEN0bC5sb2FkRGF0YShjb2RlLCBmdW5jdGlvbiAoZmVhdHVyZXMpIHsKICAgICAgICAgICAgICAgIGxldCBjZW50ZXIgPSAoY29kZSBpbiBQcm92aW5jZXMpID8gUHJvdmluY2VzW2NvZGVdLmNwIDogbnVsbDsKICAgICAgICAgICAgICAgIGlmIChmZWF0dXJlcy5mZWF0dXJlc1swXSkgY2VudGVyID0gZmVhdHVyZXMuZmVhdHVyZXNbMF0ucHJvcGVydGllcy5jcDsKICAgICAgICAgICAgICAgICR0aGlzLm1hcC5zZXRDZW50ZXIoY2VudGVyKTsKICAgICAgICAgICAgICAgICR0aGlzLm1hcC5zZXRab29tKDExKTsKICAgICAgICAgICAgICAgICR0aGlzLmRhdGEgPSBmZWF0dXJlczsKICAgICAgICAgICAgICAgICR0aGlzLmxvYWRNYXAoJHRoaXMubWFwSW5kZXgsIGZlYXR1cmVzKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgfSwKICAgICAgICBsb2FkTWFwKGlkeCwgZmVhdHVyZXMpIHsKICAgICAgICAgICAgbGV0IGZ1bnMgPSBbbG9hZFBvbHlnb24sIGxvYWRCdWlsZGluZywgbG9hZExpbmVzM0RdOwogICAgICAgICAgICBmdW5zW2lkeF0odGhpcy5tYXAsIGZlYXR1cmVzKTsKICAgICAgICB9LAogICAgICAgIHJlc2V0TWFwOiBmdW5jdGlvbiAoaWR4KSB7CiAgICAgICAgICAgIGxldCBpdGVtID0gdGhpcy5tYXBzW2lkeF07CiAgICAgICAgICAgIFV0aWxzLnNldENvb2tpZSgibWFwU3R5bGUiLCBbaXRlbS5tYXAsIGl0ZW0udHlwZV0uam9pbigiXyIpKTsKICAgICAgICAgICAgVXRpbHMuc2V0Q29va2llKCJtYXBJbmRleCIsIGlkeCk7CiAgICAgICAgICAgIHRoaXMubWFwLnJlbW92ZSgpOwogICAgICAgICAgICB0aGlzLm1hcCA9IG51bGw7CiAgICAgICAgICAgIHRoaXMuaW5pdCgpOwogICAgICAgICAgICB0aGlzLmxvYWRNYXAoaWR4LCB0aGlzLmRhdGEpOwogICAgICAgIH0KICAgIH0KfQo="},{"version":3,"sources":["Map.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAkCA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Map.vue","sourceRoot":"src/components","sourcesContent":["<template>\n    <div id=\"root\">\n        <div id=\"map\" style=\"height: 100%\">地图</div>\n        <div style=\"position: fixed; right: 10px; top: 160px; width: 100px; \">\n            <el-select v-model=\"currentProvince\" size=\"small\" placeholder=\"请选择\" @change=\"loadProvince\">\n                <el-option\n                        v-for=\"item in provinces\"\n                        :key=\"item.code\"\n                        :label=\"item.name\"\n                        :value=\"item.code\">\n                </el-option>\n            </el-select>\n        </div>\n\n        <div style=\"position: fixed; right: 10px; top: 120px; width: 100px\">\n            <el-select v-model=\"mapIndex\" size=\"small\" placeholder=\"请选择\" @change=\"resetMap\">\n                <el-option\n                        v-for=\"item in maps\"\n                        :key=\"item.index\"\n                        :label=\"item.label\"\n                        :value=\"item.index\">\n                </el-option>\n            </el-select>\n        </div>\n\n        <div style=\"position: fixed; right: 10px; top: 90px; font-weight: 400; font-family: 宋体;  \" class=\"blink\">\n            <router-link to=\"/china\">返回</router-link>\n        </div>\n    </div>\n\n\n</template>\n\n<script>\n    import {MapCtl, loadPolygon} from \"../js/map\";\n    import {Provinces} from \"../js/region\";\n    import * as maptalks from 'maptalks';\n    import {loadBuilding} from \"../js/building\";\n    import {loadLines3D} from \"../js/lines3D\";\n    import {Utils} from '../js/utils';\n\n    export default {\n        name: 'Map',\n        data() {\n            return {\n                map: null,\n                planeLayer: null,\n                buildingLayer: null,\n                currentProvince: \"510000\",\n                currentCity: \"\",\n                data: null,\n                maps: [\n                    {label: '常规地图', map: 'Gaode', type: '0', index: 0},\n                    {label: '暗黑2.5D', map: 'Gaode', type: '1', index: 1},\n                    {label: '3D场景', map: 'Gaode', type: '1', index: 2}],\n                mapIndex: 1,\n                provinces: Object.keys(Provinces).map(k => ({code: k, name: Provinces[k].name}))\n            };\n        },\n        mounted() {\n            this.mapIndex = parseInt(Utils.getCookie(\"mapIndex\", 1));\n            this.init();\n            this.loadProvince(this.currentProvince);\n        },\n        methods: {\n            init() {\n                let mapConfig = MapCtl.getConfig();\n                this.map = new maptalks.Map('map', mapConfig);\n                this.map.on('moveend', MapCtl.handleMapMove);\n            },\n            loadProvince(code) {\n                let $this = this;\n                MapCtl.loadData(code, function (features) {\n                    let center = (code in Provinces) ? Provinces[code].cp : null;\n                    if (features.features[0]) center = features.features[0].properties.cp;\n                    $this.map.setCenter(center);\n                    $this.map.setZoom(11);\n                    $this.data = features;\n                    $this.loadMap($this.mapIndex, features);\n                });\n            },\n            loadMap(idx, features) {\n                let funs = [loadPolygon, loadBuilding, loadLines3D];\n                funs[idx](this.map, features);\n            },\n            resetMap: function (idx) {\n                let item = this.maps[idx];\n                Utils.setCookie(\"mapStyle\", [item.map, item.type].join(\"_\"));\n                Utils.setCookie(\"mapIndex\", idx);\n                this.map.remove();\n                this.map = null;\n                this.init();\n                this.loadMap(idx, this.data);\n            }\n        }\n    }\n</script>\n\n<!-- Add \"scoped\" attribute to limit CSS to this component only -->\n<style>\n    .pageHead {\n        height: 100px !important;\n        padding-top: 5px !important;\n        padding-bottom: 10px !important;\n    }\n\n    #root {\n        height: calc(100% - 115px);\n    }\n\n    a {\n        color: #dd4814\n    }\n\n    .el-input__inner {\n        color: #fff;\n        background-color: #0c2c45\n    }\n\n    .content {\n        color: #fff;\n        width: 190px;\n        height: 80px;\n        background-color: #051127;\n        border: 1px solid #0c2c45\n    }\n\n    .pop_title {\n        float: left;\n        padding-left: 10px;\n        width: 180px;\n        height: 36px;\n        line-height: 36px;\n        background: url(../assets/title.png);\n        font-weight: bold;\n        font-size: 16px\n    }\n\n    .pop_dept {\n        float: left;\n        padding: 12px 5px;\n        line-height: 15px;\n        text-align: center;\n        margin: 0 10px\n    }\n\n    .pop_arrow {\n        float: left;\n        width: 15px;\n        height: 24px;\n        line-height: 24px;\n        background: url(../assets/arrow.png) no-repeat center center\n    }\n\n    .arrow {\n        display: block;\n        width: 17px;\n        height: 10px;\n        background: url(../assets/em.png) no-repeat;\n        position: absolute;\n        left: 50%;\n        margin-left: -5px;\n        bottom: -10px\n    }\n</style>\n"]}]}