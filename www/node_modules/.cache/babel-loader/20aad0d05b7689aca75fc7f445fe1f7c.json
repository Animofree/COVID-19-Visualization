{"remainingRequest":"C:\\Users\\Meng Yin\\Desktop\\COVID-19-Visualization-master\\www\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\Meng Yin\\Desktop\\COVID-19-Visualization-master\\www\\node_modules\\eslint-loader\\index.js??ref--13-0!C:\\Users\\Meng Yin\\Desktop\\COVID-19-Visualization-master\\www\\src\\js\\bloom.js","dependencies":[{"path":"C:\\Users\\Meng Yin\\Desktop\\COVID-19-Visualization-master\\www\\src\\js\\bloom.js","mtime":1584631036000},{"path":"C:\\Users\\Meng Yin\\Desktop\\COVID-19-Visualization-master\\www\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Meng Yin\\Desktop\\COVID-19-Visualization-master\\www\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"C:\\Users\\Meng Yin\\Desktop\\COVID-19-Visualization-master\\www\\node_modules\\eslint-loader\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICogYXMgVEhSRUUgZnJvbSAidGhyZWUiOwppbXBvcnQgeyBUaHJlZUxheWVyIH0gZnJvbSAnbWFwdGFsa3MudGhyZWUnOwppbXBvcnQgeyBFZmZlY3RDb21wb3NlciB9IGZyb20gJy4vbGlicy9FZmZlY3RDb21wb3Nlcic7CmltcG9ydCBSZW5kZXJQYXNzIGZyb20gJy4vbGlicy9SZW5kZXJQYXNzJzsKaW1wb3J0IFVucmVhbEJsb29tUGFzcyBmcm9tICIuL2xpYnMvVW5yZWFsQmxvb21QYXNzIjsKCmZ1bmN0aW9uIF9pbml0Qmxvb20oKSB7CiAgdmFyIHBhcmFtcyA9IHsKICAgIGV4cG9zdXJlOiAxLAogICAgYmxvb21TdHJlbmd0aDogNC41LAogICAgYmxvb21UaHJlc2hvbGQ6IDAsCiAgICBibG9vbVJhZGl1czogMCwKICAgIGRlYnVnOiBmYWxzZQogIH07CiAgdmFyIHJlbmRlcmVyID0gdGhpcy5nZXRUaHJlZVJlbmRlcmVyKCk7CiAgdmFyIHNpemUgPSB0aGlzLmdldE1hcCgpLmdldFNpemUoKTsKICB0aGlzLmNvbXBvc2VyID0gbmV3IEVmZmVjdENvbXBvc2VyKHJlbmRlcmVyKTsKICB0aGlzLmNvbXBvc2VyLnNldFNpemUoc2l6ZS53aWR0aCwgc2l6ZS5oZWlnaHQpOwogIHZhciBzY2VuZSA9IHRoaXMuZ2V0U2NlbmUoKSwKICAgICAgY2FtZXJhID0gdGhpcy5nZXRDYW1lcmEoKTsKICB0aGlzLnJlbmRlclBhc3MgPSBuZXcgUmVuZGVyUGFzcyhzY2VuZSwgY2FtZXJhKTsKICB0aGlzLmNvbXBvc2VyLmFkZFBhc3ModGhpcy5yZW5kZXJQYXNzKTsKICB2YXIgYmxvb21QYXNzID0gdGhpcy5ibG9vbVBhc3MgPSBuZXcgVW5yZWFsQmxvb21QYXNzKG5ldyBUSFJFRS5WZWN0b3IyKHNpemUud2lkdGgsIHNpemUuaGVpZ2h0KSk7CiAgYmxvb21QYXNzLnJlbmRlclRvU2NyZWVuID0gdHJ1ZTsKICBibG9vbVBhc3MudGhyZXNob2xkID0gcGFyYW1zLmJsb29tVGhyZXNob2xkOwogIGJsb29tUGFzcy5zdHJlbmd0aCA9IHBhcmFtcy5ibG9vbVN0cmVuZ3RoOwogIGJsb29tUGFzcy5yYWRpdXMgPSBwYXJhbXMuYmxvb21SYWRpdXM7IC8vIGNvbXBvc2VyLnNldFNpemUoc2l6ZS53aWR0aCwgc2l6ZS5oZWlnaHQpOwogIC8vIGNvbXBvc2VyLmFkZFBhc3MocmVuZGVyUGFzcyk7CgogIHRoaXMuY29tcG9zZXIuYWRkUGFzcyhibG9vbVBhc3MpOwogIHRoaXMuYmxvb21FbmFibGUgPSB0cnVlOwp9CgpmdW5jdGlvbiBzZXRSZW5kZXJlclJlbmRlclNjZW5lKCkgewogIHRoaXMuZ2V0UmVuZGVyZXIoKS5yZW5kZXJTY2VuZSA9IGZ1bmN0aW9uICgpIHsKICAgIHZhciBsYXllciA9IHRoaXMubGF5ZXI7CgogICAgbGF5ZXIuX2NhbGxiYWNrQmFzZU9iamVjdEFuaW1hdGlvbigpOwoKICAgIHRoaXMuX3N5bmNDYW1lcmEoKTsKCiAgICB2YXIgcmVuZGVyZXIgPSB0aGlzLmNvbnRleHQsCiAgICAgICAgY2FtZXJhID0gdGhpcy5jYW1lcmEsCiAgICAgICAgc2NlbmUgPSB0aGlzLnNjZW5lOwoKICAgIGlmIChsYXllci5ibG9vbUVuYWJsZSAmJiBsYXllci5jb21wb3NlciAmJiBsYXllci5jb21wb3Nlci5wYXNzZXMubGVuZ3RoID4gMSkgewogICAgICBpZiAocmVuZGVyZXIuYXV0b0NsZWFyKSB7CiAgICAgICAgcmVuZGVyZXIuYXV0b0NsZWFyID0gZmFsc2U7CiAgICAgIH0KCiAgICAgIGlmIChsYXllci5ibG9vbVBhc3MpIHsKICAgICAgICBjYW1lcmEubGF5ZXJzLnNldCgxKTsKICAgICAgfQoKICAgICAgaWYgKGxheWVyICYmIGxheWVyLmNvbXBvc2VyKSB7CiAgICAgICAgbGF5ZXIuY29tcG9zZXIucmVuZGVyKDApOwogICAgICB9CgogICAgICByZW5kZXJlci5jbGVhckRlcHRoKCk7CiAgICAgIGNhbWVyYS5sYXllcnMuc2V0KDApOwogICAgICByZW5kZXJlci5yZW5kZXIoc2NlbmUsIGNhbWVyYSk7CiAgICB9IGVsc2UgewogICAgICBpZiAoIXJlbmRlcmVyLmF1dG9DbGVhcikgewogICAgICAgIHJlbmRlcmVyLmF1dG9DbGVhciA9IHRydWU7CiAgICAgIH0KCiAgICAgIHJlbmRlcmVyLnJlbmRlcihzY2VuZSwgY2FtZXJhKTsKICAgIH0KCiAgICB0aGlzLmNvbXBsZXRlUmVuZGVyKCk7CiAgfTsKfQoKZnVuY3Rpb24gSW5pdEJsb29tKCkgewogIFRocmVlTGF5ZXIucHJvdG90eXBlLmluaXRCbG9vbSA9IF9pbml0Qmxvb207CiAgVGhyZWVMYXllci5wcm90b3R5cGUuc2V0UmVuZGVyZXJSZW5kZXJTY2VuZSA9IHNldFJlbmRlcmVyUmVuZGVyU2NlbmU7Cn0gLy8gSW5pdEJsb29tKCk7CgoKZXhwb3J0IHsgSW5pdEJsb29tIH07"},{"version":3,"sources":["C:/Users/Meng Yin/Desktop/COVID-19-Visualization-master/www/src/js/bloom.js"],"names":["THREE","ThreeLayer","EffectComposer","RenderPass","UnrealBloomPass","_initBloom","params","exposure","bloomStrength","bloomThreshold","bloomRadius","debug","renderer","getThreeRenderer","size","getMap","getSize","composer","setSize","width","height","scene","getScene","camera","getCamera","renderPass","addPass","bloomPass","Vector2","renderToScreen","threshold","strength","radius","bloomEnable","setRendererRenderScene","getRenderer","renderScene","layer","_callbackBaseObjectAnimation","_syncCamera","context","passes","length","autoClear","layers","set","render","clearDepth","completeRender","InitBloom","prototype","initBloom"],"mappings":"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","sourcesContent":["import * as THREE from \"three\";\nimport { ThreeLayer } from 'maptalks.three';\nimport { EffectComposer }  from './libs/EffectComposer';\nimport RenderPass  from './libs/RenderPass';\nimport UnrealBloomPass from \"./libs/UnrealBloomPass\";\n\n\nfunction _initBloom () {\n    const params = {\n        exposure: 1,\n        bloomStrength: 4.5,\n        bloomThreshold: 0,\n        bloomRadius: 0,\n        debug: false\n    };\n    const renderer = this.getThreeRenderer();\n    const size = this.getMap().getSize();\n\n    this.composer = new EffectComposer(renderer);\n    this.composer.setSize(size.width, size.height);\n    \n\n    const scene = this.getScene(), camera = this.getCamera();\n    this.renderPass = new RenderPass(scene, camera);\n\n    this.composer.addPass(this.renderPass);\n\n    const bloomPass = this.bloomPass = new UnrealBloomPass(new THREE.Vector2(size.width, size.height));\n    bloomPass.renderToScreen = true;\n    bloomPass.threshold = params.bloomThreshold;\n    bloomPass.strength = params.bloomStrength;\n    bloomPass.radius = params.bloomRadius;\n\n    // composer.setSize(size.width, size.height);\n    // composer.addPass(renderPass);\n    this.composer.addPass(bloomPass);\n    this.bloomEnable = true;\n}\n\nfunction setRendererRenderScene () {\n    this.getRenderer().renderScene = function () {\n        const layer = this.layer;\n        layer._callbackBaseObjectAnimation();\n        this._syncCamera();\n\n        const renderer = this.context, camera = this.camera, scene = this.scene;\n        if (layer.bloomEnable && layer.composer && layer.composer.passes.length > 1) {\n            if (renderer.autoClear) {\n                renderer.autoClear = false;\n            }\n            if (layer.bloomPass) {\n                camera.layers.set(1);\n            }\n            if (layer && layer.composer) {\n                layer.composer.render(0);\n            }\n            renderer.clearDepth();\n            camera.layers.set(0);\n            renderer.render(scene, camera);\n        } else {\n            if (!renderer.autoClear) {\n                renderer.autoClear = true;\n            }\n            renderer.render(scene, camera);\n        }\n\n        this.completeRender();\n    }\n}\n\nfunction InitBloom () {\n    ThreeLayer.prototype.initBloom = _initBloom;\n    ThreeLayer.prototype.setRendererRenderScene = setRendererRenderScene;\n}\n\n// InitBloom();\n\nexport {InitBloom};"]}]}