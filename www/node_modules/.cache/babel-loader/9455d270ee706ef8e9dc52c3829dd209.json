{"remainingRequest":"C:\\Users\\Meng Yin\\Desktop\\COVID-19-Visualization-master\\www\\node_modules\\thread-loader\\dist\\cjs.js!C:\\Users\\Meng Yin\\Desktop\\COVID-19-Visualization-master\\www\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\Meng Yin\\Desktop\\COVID-19-Visualization-master\\www\\node_modules\\eslint-loader\\index.js??ref--13-0!C:\\Users\\Meng Yin\\Desktop\\COVID-19-Visualization-master\\www\\src\\js\\building.js","dependencies":[{"path":"C:\\Users\\Meng Yin\\Desktop\\COVID-19-Visualization-master\\www\\src\\js\\building.js","mtime":1584631036000},{"path":"C:\\Users\\Meng Yin\\Desktop\\COVID-19-Visualization-master\\www\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Meng Yin\\Desktop\\COVID-19-Visualization-master\\www\\node_modules\\thread-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Meng Yin\\Desktop\\COVID-19-Visualization-master\\www\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"C:\\Users\\Meng Yin\\Desktop\\COVID-19-Visualization-master\\www\\node_modules\\eslint-loader\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZm9yLWVhY2giOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5mdW5jdGlvbi5uYW1lIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvd2ViLmRvbS1jb2xsZWN0aW9ucy5mb3ItZWFjaCI7CmltcG9ydCAqIGFzIG1hcHRhbGtzIGZyb20gJ21hcHRhbGtzJzsKaW1wb3J0ICogYXMgVEhSRUUgZnJvbSAidGhyZWUiOwppbXBvcnQgeyBUaHJlZUxheWVyIH0gZnJvbSAnbWFwdGFsa3MudGhyZWUnOwovKiAKICAgIOWcsOWbvuS4ijNE5Y+R5YWJ5p+x54q25bu6562R54mp5Zu+CiovCi8vIHBhcmFtOgovLyBtYXAgLSBtYXB0YWxrcyBpbnN0YW5jZQovLyBkYXRhIC0gR2VvSnNvbgoKZnVuY3Rpb24gbG9hZEJ1aWxkaW5nKG1hcCwgZGF0YSkgewogIHZhciB0aHJlZUxheWVyID0gbWFwLmdldExheWVyKCdidWlsZGluZycpOwogIHZhciBsYWJlbExheWVyID0gbWFwLmdldExheWVyKCdsYWJlbCcpOwoKICBpZiAodGhyZWVMYXllcikgewogICAgdGhyZWVMYXllci5yZW1vdmUoKTsKICAgIGxhYmVsTGF5ZXIucmVtb3ZlKCk7CiAgfQoKICB0aHJlZUxheWVyID0gbmV3IFRocmVlTGF5ZXIoJ2J1aWxkaW5nJywgewogICAgZm9yY2VSZW5kZXJPbk1vdmluZzogdHJ1ZSwKICAgIGZvcmNlUmVuZGVyT25Sb3RhdGluZzogdHJ1ZQogIH0pOwogIGxhYmVsTGF5ZXIgPSBuZXcgbWFwdGFsa3MuVmVjdG9yTGF5ZXIoImxhYmVsIikuYWRkVG8obWFwKTsKICB2YXIgbWVzaHMgPSBbXTsKICB2YXIgbWF0ZXJpYWwgPSBuZXcgVEhSRUUuTWVzaEJhc2ljTWF0ZXJpYWwoewogICAgY29sb3I6ICcjRjU1MjUzJywKICAgIHRyYW5zcGFyZW50OiB0cnVlCiAgfSk7CiAgdmFyIGhpZ2hsaWdodG1hdGVyaWFsID0gbmV3IFRIUkVFLk1lc2hCYXNpY01hdGVyaWFsKHsKICAgIGNvbG9yOiAncmVkJywKICAgIHRyYW5zcGFyZW50OiB0cnVlCiAgfSk7CgogIHRocmVlTGF5ZXIucHJlcGFyZVRvRHJhdyA9IGZ1bmN0aW9uIChnbCwgc2NlbmUpIHsKICAgIHZhciBsaWdodCA9IG5ldyBUSFJFRS5EaXJlY3Rpb25hbExpZ2h0KDB4ZmZmZmZmKTsKICAgIGxpZ2h0LnBvc2l0aW9uLnNldCgwLCAtMTAsIDEwKS5ub3JtYWxpemUoKTsKICAgIHNjZW5lLmFkZChsaWdodCk7CiAgICBkYXRhLmZlYXR1cmVzLmZvckVhY2goZnVuY3Rpb24gKGcpIHsKICAgICAgdmFyIGhlaWdodFBlckxldmVsID0gNTA7CiAgICAgIHZhciBsZXZlbHMgPSBnLnByb3BlcnRpZXMubGV2ZWxzIHx8IDY7CiAgICAgIHZhciBtZXNoID0gdGhyZWVMYXllci50b0V4dHJ1ZGVQb2x5Z29uKG1hcHRhbGtzLkdlb0pTT04udG9HZW9tZXRyeShnKSwgewogICAgICAgIGhlaWdodDogbGV2ZWxzICogaGVpZ2h0UGVyTGV2ZWwsCiAgICAgICAgdG9wQ29sb3I6ICcjZmZmJwogICAgICB9LCBtYXRlcmlhbCk7CiAgICAgIG1lc2guc2V0SW5mb1dpbmRvdyhnZXRJbmZvKGcpKTsKICAgICAgWydtb3VzZW91dCcsICdtb3VzZW92ZXInXS5mb3JFYWNoKGZ1bmN0aW9uIChldmVudFR5cGUpIHsKICAgICAgICBtZXNoLm9uKGV2ZW50VHlwZSwgZnVuY3Rpb24gKGUpIHsKICAgICAgICAgIGlmIChlLnR5cGUgPT09ICdtb3VzZW91dCcpIHRoaXMuc2V0U3ltYm9sKG1hdGVyaWFsKTsKICAgICAgICAgIGlmIChlLnR5cGUgPT09ICdtb3VzZW92ZXInKSB0aGlzLnNldFN5bWJvbChoaWdobGlnaHRtYXRlcmlhbCk7CiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgICBtZXNocy5wdXNoKG1lc2gpOyAvLyDlop7liqDmloflrZfmoIfnrb4KCiAgICAgIGNyZWF0ZUxhYmVsKGcpLmFkZFRvKGxhYmVsTGF5ZXIpOwogICAgfSk7CiAgICB0aHJlZUxheWVyLmFkZE1lc2gobWVzaHMpOwogICAgdGhyZWVMYXllci5jb25maWcoJ2FuaW1hdGlvbicsIHRydWUpOwogIH07CgogIHRocmVlTGF5ZXIuYWRkVG8obWFwKTsKfQoKZnVuY3Rpb24gY3JlYXRlTGFiZWwoZmVhdHVyZSkgewogIHZhciBwb3MgPSBmZWF0dXJlLnByb3BlcnRpZXMuY3A7CiAgdmFyIG5hbWUgPSBmZWF0dXJlLnByb3BlcnRpZXMubmFtZTsKICB2YXIgY29vcmQgPSBbcG9zWzBdLCBwb3NbMV0gLSAwLjAwMjJdOwogIHZhciBsYWJlbCA9IG5ldyBtYXB0YWxrcy5MYWJlbChuYW1lLCBjb29yZCwgewogICAgJ2RyYWdnYWJsZSc6IHRydWUsCiAgICAndGV4dFN5bWJvbCc6IHsKICAgICAgJ3RleHRGYWNlTmFtZSc6ICdtb25vc3BhY2UnLAogICAgICAndGV4dEZpbGwnOiAnIzM0NDk1ZScsCiAgICAgICd0ZXh0SGFsb0ZpbGwnOiAnI2ZmZicsCiAgICAgICd0ZXh0SGFsb1JhZGl1cyc6IDQsCiAgICAgICd0ZXh0U2l6ZSc6IDE4LAogICAgICAndGV4dFdlaWdodCc6ICdib2xkJywKICAgICAgJ3RleHRWZXJ0aWNhbEFsaWdubWVudCc6ICd0b3AnCiAgICB9LAogICAgJ2JveFN0eWxlJzogewogICAgICAncGFkZGluZyc6IFsxMiwgOF0KICAgIH0KICB9KTsKICBsYWJlbC5zZXRJbmZvV2luZG93KGdldEluZm8oZmVhdHVyZSkpOwogIGxhYmVsLm9uKCdjbGljaycsIGZ1bmN0aW9uICgpIHsKICAgIHRoaXMub3BlbkluZm9XaW5kb3coKTsKICB9KTsKICByZXR1cm4gbGFiZWw7Cn0gLy8g5L6d6LWW5LqOY3Nz77yM6KeBTWFwLnZ1ZQoKCmZ1bmN0aW9uIGdldEluZm8oZmVhdHVyZSkgewogIHJldHVybiB7CiAgICAnc2luZ2xlJzogdHJ1ZSwKICAgICd3aWR0aCc6IDI4MywKICAgICdoZWlnaHQnOiAxMDUsCiAgICAnY3VzdG9tJzogdHJ1ZSwKICAgICdkeCc6IC0zLAogICAgJ2R5JzogLTEyLAogICAgJ2NvbnRlbnQnOiAnPGRpdiBjbGFzcz0iY29udGVudCI+JyArICc8ZGl2IGNsYXNzPSJwb3BfdGl0bGUiPicgKyBmZWF0dXJlLnByb3BlcnRpZXMubmFtZSArICc8L2Rpdj4nICsgJzxkaXYgY2xhc3M9InBvcF9kZXB0Ij7ml7bpl7TvvJonICsgZmVhdHVyZS5wcm9wZXJ0aWVzLmRhdGUgKyAnPC9kaXY+JyArICc8ZGl2IGNsYXNzPSJhcnJvdyI+PC9kaXY+JyArICc8L2Rpdj4nCiAgfTsKfQoKZXhwb3J0IHsgbG9hZEJ1aWxkaW5nLCBnZXRJbmZvIH07"},{"version":3,"sources":["C:/Users/Meng Yin/Desktop/COVID-19-Visualization-master/www/src/js/building.js"],"names":["maptalks","THREE","ThreeLayer","loadBuilding","map","data","threeLayer","getLayer","labelLayer","remove","forceRenderOnMoving","forceRenderOnRotating","VectorLayer","addTo","meshs","material","MeshBasicMaterial","color","transparent","highlightmaterial","prepareToDraw","gl","scene","light","DirectionalLight","position","set","normalize","add","features","forEach","g","heightPerLevel","levels","properties","mesh","toExtrudePolygon","GeoJSON","toGeometry","height","topColor","setInfoWindow","getInfo","eventType","on","e","type","setSymbol","push","createLabel","addMesh","config","feature","pos","cp","name","coord","label","Label","openInfoWindow","date"],"mappings":"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","sourcesContent":["import * as maptalks from 'maptalks';\nimport * as THREE from \"three\";\nimport { ThreeLayer } from 'maptalks.three';\n\n/* \n    地图上3D发光柱状建筑物图\n*/\n\n\n// param:\n// map - maptalks instance\n// data - GeoJson\nfunction loadBuilding (map, data) {\n    let threeLayer = map.getLayer('building');\n    let labelLayer = map.getLayer('label');\n    if (threeLayer) {\n        threeLayer.remove();\n        labelLayer.remove();\n    }\n    threeLayer = new ThreeLayer('building', {\n        forceRenderOnMoving: true, forceRenderOnRotating: true\n    });\n    labelLayer = new maptalks.VectorLayer(\"label\").addTo(map);\n    \n    let meshs = [];\n    let material = new THREE.MeshBasicMaterial({ color: '#F55253', transparent: true });\n    let highlightmaterial = new THREE.MeshBasicMaterial({ color: 'red', transparent: true });\n\n    threeLayer.prepareToDraw = function (gl, scene) {\n        let light = new THREE.DirectionalLight(0xffffff);\n        light.position.set(0, -10, 10).normalize();\n        scene.add(light);\n        data.features.forEach(function (g) {\n            let heightPerLevel = 50;\n            let levels = g.properties.levels || 6;\n            let mesh = threeLayer.toExtrudePolygon(maptalks.GeoJSON.toGeometry(g), {\n                height: levels * heightPerLevel, topColor: '#fff'\n            }, material);\n            mesh.setInfoWindow(getInfo(g));\n\n            ['mouseout', 'mouseover'].forEach(function (eventType) {\n                mesh.on(eventType, function (e) {\n                    if (e.type === 'mouseout') this.setSymbol(material);\n                    if (e.type === 'mouseover') this.setSymbol(highlightmaterial);\n                });\n            });\n            meshs.push(mesh);\n            \n            // 增加文字标签\n            createLabel(g).addTo(labelLayer); \n        });\n        threeLayer.addMesh(meshs);\n        threeLayer.config('animation', true);\n    };\n    threeLayer.addTo(map);\n}\n\nfunction createLabel (feature) {\n    let pos = feature.properties.cp;\n    let name = feature.properties.name;\n    let coord = [pos[0], pos[1] - 0.0022];\n    let label = new maptalks.Label(name,\n        coord,\n        {\n            'draggable' : true,\n            'textSymbol': {\n                'textFaceName' : 'monospace',\n                'textFill' : '#34495e',\n                'textHaloFill' : '#fff',\n                'textHaloRadius' : 4,\n                'textSize' : 18,\n                'textWeight' : 'bold',\n                'textVerticalAlignment' : 'top'\n            },\n            'boxStyle' : {\n                'padding' : [12, 8]\n            }\n        }\n    );\n    label.setInfoWindow(getInfo(feature));\n    label.on('click', function () {\n        this.openInfoWindow();\n    });\n    return label;\n}\n\n// 依赖于css，见Map.vue\nfunction getInfo (feature) {\n    return {\n        'single' : true,\n        'width'  : 283,\n        'height' : 105,\n        'custom' : true,\n        'dx' : -3,\n        'dy' : -12,\n        'content'   : '<div class=\"content\">' +\n          '<div class=\"pop_title\">' + feature.properties.name + '</div>' +\n          '<div class=\"pop_dept\">时间：' + feature.properties.date + '</div>' +\n          '<div class=\"arrow\"></div>' +\n          '</div>'\n    };\n}\nexport {loadBuilding, getInfo};"]}]}